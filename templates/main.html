<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>경수오빠못해조 - 메인</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
      rel="stylesheet"
    />
    <link href="/static/css/common.css" rel="stylesheet" />
  </head>
  <body>
    <div class="header-bar">
      <div class="container">
        <a href="/" class="logo"><i class="fas fa-paw"></i> 경수오빠못해조</a>
        <div class="search-container d-none d-md-block">
          <form action="/products" method="get">
            <div class="search-input-group">
              <input
                type="text"
                name="keyword"
                class="search-input"
                placeholder="찾으시는 상품이 있나요?"
                value="{{ keyword if keyword else '' }}"
              />
              <button class="search-btn" type="submit">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </form>
        </div>
        <div class="header-nav">
          {% if username %}
          <span class="user-greeting d-none d-lg-block"
            ><i class="fas fa-user-circle"></i> {{ username }}님</span
          >
          <div class="dropdown">
            <a href="#" class="menu-btn dropdown-toggle" data-toggle="dropdown"
              ><i class="fas fa-bars"></i> 메뉴</a
            >
            <div class="dropdown-menu custom-dropdown">
              <a href="/" class="dropdown-item"
                ><i class="fas fa-home"></i> 메인</a
              >
              <a href="/mypage" class="dropdown-item"
                ><i class="fas fa-user-cog"></i> 마이페이지</a
              >
              <a href="/memos" class="dropdown-item"
                ><i class="fas fa-clipboard-list"></i> 게시판</a
              >
              <div class="dropdown-divider"></div>
              <a href="#" onclick="logout()" class="dropdown-item text-danger"
                ><i class="fas fa-sign-out-alt"></i> 로그아웃</a
              >
            </div>
          </div>
          {% else %}
          <div class="dropdown">
            <a href="#" class="menu-btn dropdown-toggle" data-toggle="dropdown"
              ><i class="fas fa-user"></i> 시작하기</a
            >
            <div class="dropdown-menu custom-dropdown">
              <a href="/login" class="dropdown-item"
                ><i class="fas fa-sign-in-alt"></i> 로그인</a
              >
              <a href="/" class="dropdown-item"
                ><i class="fas fa-home"></i> 메인 둘러보기</a
              >
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    {% include "navbar.html" %}

    <div class="container">
      <div class="main-banner">
        <div class="banner-content">
          <h2 class="banner-title">경수오빠못해조 오픈 기념!</h2>
          <p class="banner-text">
            우리집 반려동물을 위한 특별한 선물<br />
            <strong>전 품목 최대 50% 할인 이벤트 중</strong>
          </p>
          <button
            class="btn-shopping"
            onclick="location.href='/products?category=dog&sub=food'"
          >
            <i class="fas fa-shopping-cart"></i> 지금 쇼핑하기
          </button>
        </div>
      </div>
    </div>

    <div class="container mb-5">
      <div class="section-header">
        <h3 class="section-title">
          <i class="fas fa-star text-warning"></i> MD 추천 상품
        </h3>
      </div>

      <div class="row">
        {% for product in featured_products %}
        <div class="col-md-3 mb-4">
          <div
            class="card product-card"
            onclick="location.href='/products/{{ product.id }}'"
          >
            <div class="card-img-wrapper">
              <div class="card-badge"><i class="fas fa-heart"></i></div>

              {% if product.image_url %}
              <img
                src="{{ product.image_url }}"
                alt="{{ product.name }}"
                class="card-img-top"
              />
              {% else %}
              <div
                class="d-flex align-items-center justify-content-center h-100 bg-light text-secondary"
              >
                <i class="fas fa-gift fa-3x"></i>
              </div>
              {% endif %}
            </div>

            <div class="card-body">
              <h5 class="card-title">{{ product.name }}</h5>
              <p class="product-price">{{ product.price }}원</p>
            </div>
          </div>
        </div>
        {% else %}
        <div class="col-12 text-center">
          <p>추천 상품 준비 중입니다.</p>
        </div>
        {% endfor %}
      </div>
    </div>
    {% include "chatbot.html" %}
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script>
      function logout() {
        fetch("/auth/logout", { method: "POST" }).then(
          () => (window.location.href = "/")
        );
      }
    </script>
  </body>
</html>
